#ifndef HANDSHAKE_H
#define HANDSHAKE_H

#ifdef __cplusplus
extern "C"
{
#endif

/*
****************************************************************************************************
*       INCLUDE FILES
****************************************************************************************************
*/

#include <stdint.h>
#include "utils.h"


/*
****************************************************************************************************
*       MACROS
****************************************************************************************************
*/


/*
****************************************************************************************************
*       CONFIGURATION
****************************************************************************************************
*/


/*
****************************************************************************************************
*       DATA TYPES
****************************************************************************************************
*/

enum {CC_HANDSHAKE_OK, CC_UPDATE_AVAILABLE, CC_UPDATE_REQUIRED};

typedef struct cc_handshake_t {
    string_t *uri;
    uint16_t random_id;
    version_t protocol, firmware;
    void (*callback)(void *arg);
} cc_handshake_t;

typedef struct cc_handshake_mod_t {
    uint16_t random_id;
    int status, device_id, channel;
} cc_handshake_mod_t;


/*
****************************************************************************************************
*       FUNCTION PROTOTYPES
****************************************************************************************************
*/

cc_handshake_t *cc_handshake_generate(string_t *uri);
void cc_handshake_callback(void (*handshake_cb)(void *arg));


/*
****************************************************************************************************
*       CONFIGURATION ERRORS
****************************************************************************************************
*/

#ifdef __cplusplus
}
#endif

#endif
